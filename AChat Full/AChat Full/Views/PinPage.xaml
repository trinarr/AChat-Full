<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AChatFull.Views.PinPage"
             BackgroundColor="#1E88E5"
             Title="">

    <ContentPage.Resources>
        <Style TargetType="Button">
            <Setter Property="BackgroundColor" Value="#33FFFFFF"/>
            <Setter Property="TextColor" Value="White"/>
            <Setter Property="CornerRadius" Value="48"/>
            <Setter Property="HeightRequest" Value="96"/>
            <Setter Property="WidthRequest"  Value="96"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="Padding" Value="0"/>
        </Style>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="32" RowSpacing="24">

        <!-- Лого/название -->
        <StackLayout Grid.Row="0" Spacing="8" HorizontalOptions="Center">
            <Label Text="AChat" TextColor="White" FontAttributes="Bold" FontSize="24" HorizontalTextAlignment="Center"/>
            <Label Text="{Binding TitleText}" TextColor="#EAF2FF" FontSize="18" HorizontalTextAlignment="Center"/>
        </StackLayout>

        <!-- Индикаторы PIN -->
        <StackLayout Grid.Row="1"
             Orientation="Horizontal"
             Spacing="16"
             HorizontalOptions="Center">
            <!-- Пустой круг (полупрозрачный), становится ярким когда Dot1=true -->
            <BoxView WidthRequest="14" HeightRequest="14" CornerRadius="7" Color="White" Opacity="0.35">
                <BoxView.Triggers>
                    <DataTrigger TargetType="BoxView" Binding="{Binding Dot1}" Value="True">
                        <Setter Property="Opacity" Value="1" />
                    </DataTrigger>
                </BoxView.Triggers>
            </BoxView>

            <BoxView WidthRequest="14" HeightRequest="14" CornerRadius="7" Color="White" Opacity="0.35">
                <BoxView.Triggers>
                    <DataTrigger TargetType="BoxView" Binding="{Binding Dot2}" Value="True">
                        <Setter Property="Opacity" Value="1" />
                    </DataTrigger>
                </BoxView.Triggers>
            </BoxView>

            <BoxView WidthRequest="14" HeightRequest="14" CornerRadius="7" Color="White" Opacity="0.35">
                <BoxView.Triggers>
                    <DataTrigger TargetType="BoxView" Binding="{Binding Dot3}" Value="True">
                        <Setter Property="Opacity" Value="1" />
                    </DataTrigger>
                </BoxView.Triggers>
            </BoxView>

            <BoxView WidthRequest="14" HeightRequest="14" CornerRadius="7" Color="White" Opacity="0.35">
                <BoxView.Triggers>
                    <DataTrigger TargetType="BoxView" Binding="{Binding Dot4}" Value="True">
                        <Setter Property="Opacity" Value="1" />
                    </DataTrigger>
                </BoxView.Triggers>
            </BoxView>
        </StackLayout>

        <!-- Клавиатура -->
        <Grid Grid.Row="3" RowSpacing="16" ColumnSpacing="24" HorizontalOptions="Center">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- 1..9 -->
            <Button Text="1" Grid.Row="0" Grid.Column="0" Command="{Binding NumberCommand}" CommandParameter="1"/>
            <Button Text="2" Grid.Row="0" Grid.Column="1" Command="{Binding NumberCommand}" CommandParameter="2"/>
            <Button Text="3" Grid.Row="0" Grid.Column="2" Command="{Binding NumberCommand}" CommandParameter="3"/>

            <Button Text="4" Grid.Row="1" Grid.Column="0" Command="{Binding NumberCommand}" CommandParameter="4"/>
            <Button Text="5" Grid.Row="1" Grid.Column="1" Command="{Binding NumberCommand}" CommandParameter="5"/>
            <Button Text="6" Grid.Row="1" Grid.Column="2" Command="{Binding NumberCommand}" CommandParameter="6"/>

            <Button Text="7" Grid.Row="2" Grid.Column="0" Command="{Binding NumberCommand}" CommandParameter="7"/>
            <Button Text="8" Grid.Row="2" Grid.Column="1" Command="{Binding NumberCommand}" CommandParameter="8"/>
            <Button Text="9" Grid.Row="2" Grid.Column="2" Command="{Binding NumberCommand}" CommandParameter="9"/>

            <!-- левый нижний — отпечаток -->
            <ImageButton Grid.Row="3" Grid.Column="0"
             Source="fingerprint.png"
             Command="{Binding BiometricsCommand}"
             IsVisible="{Binding ShowBiometricButton}" />

            <!-- 0 -->
            <Button Text="0" Grid.Row="3" Grid.Column="1" Command="{Binding NumberCommand}" CommandParameter="0"/>

            <!-- Backspace -->
            <ImageButton Grid.Row="3" Grid.Column="2"
                   Source="backspace.png"
                   BackgroundColor="#33FFFFFF"
                   CornerRadius="48"
                   HeightRequest="96" WidthRequest="96"
                   Command="{Binding DeleteCommand}"/>
        </Grid>
    </Grid>
</ContentPage>